<!doctype html>
<html lang="th">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>üíº ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ - Fuji Mobile Shop</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- SheetJS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Kanit', 'Noto Sans Lao', sans-serif;
            background-color: #f8f9fa;
        }

        header {
            text-align: center;
            padding: 20px 0;
            background-color: #343a40;
            color: white;
            margin-bottom: 20px;
        }

        header img {
            width: 100px;
            height: auto;
            object-fit: contain;
            margin-bottom: 10px;
        }

        .table thead th {
            background-color: #343a40;
            color: white;
        }

        footer {
            text-align: center;
            padding: 20px 0;
            background-color: #343a40;
            color: white;
            margin-top: 40px;
        }

        .container h4 {
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <header>
        <img src="https://cdn.vectorstock.com/i/1000v/99/91/smartphone-repair-services-gear-up-for-mobile-vector-55249991.avif"
            alt="Logo">
        <h2>Fuji Mobile Shop</h2>
        <small>Tel: 02091940568 | WhatsApp: 02098614336</small><br>
        <a href="index.html" class="btn btn-light btn-sm mt-2">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    </header>

    <div class="container">
        <h4 class="text-center">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h4>

        <!-- Form ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ -->
        <form id="addCustomerForm" class="mb-3">
            <div class="form-row">
                <div class="col-md-2 mb-2">
                    <input type="date" id="custDate" class="form-control" placeholder="‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ">
                </div>
                <div class="col-md-2 mb-2">
                    <input type="text" id="custName" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
                </div>
                <div class="col-md-2 mb-2">
                    <input type="text" id="custPhone" class="form-control" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
                </div>
                <div class="col-md-3 mb-2">
                    <input type="email" id="custEmail" class="form-control" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                </div>
                <div class="col-md-2 mb-2">
                    <input type="text" id="custPassword" class="form-control" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                </div>
                <div class="col-md-1 mb-2">
                    <button type="submit" class="btn btn-primary btn-block">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </div>
            </div>
        </form>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel -->
        <div class="text-right mb-3">
            <button id="downloadExcel" class="btn btn-success btn-sm">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel</button>
        </div>

        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ -->
        <div class="table-responsive">
            <table class="table table-bordered table-hover table-sm text-center">
                <thead>
                    <tr>
                        <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                        <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                        <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                        <th>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</th>
                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody id="customerTableBody"></tbody>
            </table>
        </div>
    </div>

    <footer>
        üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô Fuji Mobile Shop: Tel 02091940568 | WhatsApp 02098614336<br>
        üõ† ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡πÄ‡∏£‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
    </footer>

    <script>
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        const customerTableBody = document.getElementById('customerTableBody');

        function saveCustomers() {
            localStorage.setItem('customers', JSON.stringify(customers));
        }

        function renderCustomers() {
            customerTableBody.innerHTML = '';
            customers.forEach((c, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${c.date}</td>
                    <td>${c.name}</td>
                    <td>${c.phone}</td>
                    <td>${c.email}</td>
                    <td>${c.password}</td>
                    <td>
                        <button class="btn btn-sm btn-warning edit">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button class="btn btn-sm btn-danger delete">‡∏•‡∏ö</button>
                    </td>`;
                row.querySelector('.delete').addEventListener('click', () => {
                    if (confirm('‡∏•‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏ô‡∏µ‡πâ?')) {
                        customers.splice(index, 1);
                        saveCustomers();
                        renderCustomers();
                    }
                });
                row.querySelector('.edit').addEventListener('click', () => {
                    const newDate = prompt('‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ', c.date);
                    const newName = prompt('‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà', c.name);
                    const newPhone = prompt('‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÉ‡∏´‡∏°‡πà', c.phone);
                    const newEmail = prompt('‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÉ‡∏´‡∏°‡πà', c.email);
                    const newPassword = prompt('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà', c.password);

                    if (newDate && newName && newPhone && newEmail && newPassword) {
                        customers[index] = {
                            date: newDate,
                            name: newName,
                            phone: newPhone,
                            email: newEmail,
                            password: newPassword
                        };
                        saveCustomers();
                        renderCustomers();
                    }
                });
                customerTableBody.appendChild(row);
            });
        }

        document.getElementById('addCustomerForm').addEventListener('submit', e => {
            e.preventDefault();
            const date = document.getElementById('custDate').value;
            const name = document.getElementById('custName').value.trim();
            const phone = document.getElementById('custPhone').value.trim();
            const email = document.getElementById('custEmail').value.trim();
            const password = document.getElementById('custPassword').value.trim();

            if (!date || !name || !phone || !email || !password) return alert('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö');

            customers.push({ date, name, phone, email, password });
            saveCustomers();
            renderCustomers();

            // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('custDate').value = '';
            document.getElementById('custName').value = '';
            document.getElementById('custPhone').value = '';
            document.getElementById('custEmail').value = '';
            document.getElementById('custPassword').value = '';
        });

        // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel
        document.getElementById('downloadExcel').addEventListener('click', () => {
            const wb = XLSX.utils.book_new();
            const data = [['‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ', '‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', '‡∏≠‡∏µ‡πÄ‡∏°‡∏•', '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô']];
            customers.forEach(c => data.push([c.date, c.name, c.phone, c.email, c.password]));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(data), 'Customers');
            XLSX.writeFile(wb, 'FujiMobile_Customers.xlsx');
        });

        renderCustomers();
    </script>
</body>

</html>